אם אני אהפול את DROPBEAR -FE לסרוויס לינוקי, זה יעבוד באופן שיפט?

לא, הפיכת dropbear -FE לשירות (service) לינוקסי לא תעבוד באופן ישיר בקונטיינר דוקר סטנדרטי, וזאת מכמה סיבות:

קונטיינרים של דוקר בדרך כלל לא כוללים את systemd או init system אחרת שמנהלת שירותים.
האות 'F' בפרמטרים של dropbear מציינת להריץ בפורגראונד (foreground) - זה מתאים לדוקר, אך שירותים בדרך כלל רצים בבקגראונד.
אם אתה בכל זאת צריך להפעיל שירות systemd בתוך קונטיינר דוקר, יש שתי אפשרויות:

אפשרות 1: השתמש בדוקר עם תמיכה מלאה ב-systemd (מורכב יותר):

dockerfile
FROM python:3.10

# התקנת systemd ו-dropbear
RUN apt-get update && \
    apt-get install -y systemd systemd-sysv dropbear && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# הגדרת שירות dropbear
COPY dropbear.service /etc/systemd/system/
RUN systemctl enable dropbear.service

# הגדרת תהליך האתחול
ENTRYPOINT ["/sbin/init"]
והפעלה:

bash
docker run -d --privileged -p 2222:22 --name systemd-dropbear your-image-name
אפשרות 2 (פשוטה יותר): השתמש בכלי כמו supervisord לניהול תהליכים:

dockerfile
FROM python:3.10

# התקנה
RUN apt-get update && \
    apt-get install -y dropbear supervisor && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# יצירת מפתחות
RUN mkdir -p /etc/dropbear && \
    dropbearkey -t rsa -f /etc/dropbear/dropbear_rsa_host_key && \
    dropbearkey -t dss -f /etc/dropbear/dropbear_dss_host_key

# הגדרת supervisor
COPY supervisord.conf /etc/supervisor/conf.d/supervisord.conf

EXPOSE 22

CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/conf.d/supervisord.conf"]
עם קובץ supervisord.conf:

[supervisord]
nodaemon=true

[program:dropbear]
command=/usr/sbin/dropbear -E
autorestart=true
המלצה: בדוקר, הגישה המומלצת היא להשתמש בפקודת ה-CMD הישירה כפי שעשינו במקור. זה הכי פשוט ויעיל. קונטיינרים של דוקר מיועדים בדרך כלל להריץ תהליך אחד מרכזי, ולא להתנהג כמו מערכת הפעלה מלאה.

אם אתה צריך להריץ מספר תהליכים, אז supervisord (הדוגמה השנייה) היא הגישה המקובלת.