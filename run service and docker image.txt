
FROM python:3.10

# התקנת dropbear והכלים הנדרשים
RUN apt-get update && \
    apt-get install -y dropbear && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# יצירת תיקיה להגדרות ומחיקת קבצי מפתח קיימים אם יש
RUN mkdir -p /etc/dropbear && \
    rm -f /etc/dropbear/dropbear_rsa_host_key /etc/dropbear/dropbear_dss_host_key

# יצירת מפתחות SSH חדשים
RUN dropbearkey -t rsa -f /etc/dropbear/dropbear_rsa_host_key && \
    dropbearkey -t dss -f /etc/dropbear/dropbear_dss_host_key && \
    chmod 600 /etc/dropbear/dropbear_*_host_key

# הגדרת משתמש וסיסמה לדוגמה
RUN apt-get update && apt-get install -y passwd && \
    useradd -m -s /bin/bash user && \
    echo "user:password" | chpasswd && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# חשיפת פורט 22 לחיבורי SSH
EXPOSE 22

# הפעלת dropbear בפורגראונד עם לוגים מורחבים
CMD ["/usr/sbin/dropbear", "-FE"]





----------------------------------
לצורך הפעלת פקודה כשירות (service) במערכת לינוקס, אתה יכול ליצור קובץ שירות systemd. זו הדרך המודרנית להפעיל תהליכים ברקע במערכות לינוקס. הנה כיצד תוכל להגדיר את dropbear כשירות:

יצירת קובץ שירות systemd עבור dropbear:

bashCopysudo nano /etc/systemd/system/dropbear.service

הכנס את התוכן הבא לקובץ:

Copy[Unit]
Description=Dropbear SSH Server
After=network.target

[Service]
Type=simple
ExecStart=/usr/sbin/dropbear -FE
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target

שמור את הקובץ וצא מהעורך (בnano, לחץ Ctrl+X, אז Y ואז Enter).
טען את השירות החדש:

bashCopysudo systemctl daemon-reload

הפעל את השירות:

bashCopysudo systemctl start dropbear

אם תרצה שהשירות יופעל אוטומטית בעת הפעלת המערכת:

bashCopysudo systemctl enable dropbear
פקודות שימושיות נוספות:

לבדיקת סטטוס השירות:
bashCopysudo systemctl status dropbear

להפסקת השירות:
bashCopysudo systemctl stop dropbear

להפעלה מחדש של השירות:
bashCopysudo systemctl restart dropbear


שים לב שעליך להתאים את הנתיב המדויק ל-dropbear בהתאם למערכת שלך. בחלק מההפצות זה יכול להיות בנתיב אחר, כמו /usr/bin/dropbear במקום /usr/sbin/dropbear.